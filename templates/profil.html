<!DOCTYPE html>
<html lang="fr">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description" content="Forum de voyage - Partagez vos expÃ©riences et conseils sur les destinations de la France.">
        <meta name="keywords" content="forum, voyage, destinations, partage, communautÃ©">
        <meta name="author" content="Matias, Sara, Samuel, William">
        <link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&family=Pacifico&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=Sen:wght@400;600;800&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700&display=swap" rel="stylesheet">
        <title>MyTripy</title>
        <link rel="stylesheet" href="static/css/styles.css">
        <link rel="stylesheet" href="static/css/styles-desktop.css" media="screen and (min-width: 1024px)">
    </head>
<body>

    <!-- Header -->
    <header>
        <!-- Logo -->
        <a href="/mytripy-non" class="logo">
            <img class="image_logo" src="static/img/logo/logo-mytripy-2.png" alt="MyTripy Logo">
            <img class="mytripy" src="static/img/logo/mytripy.png" alt="MyTripy">
            <!-- <span class="text_logo">My<span>Trip</span>y</span> -->
        </a>

        <!-- Menu Burger -->
        <button class="burger-menu" id="burger">
            <img src="static/img/menu-black.png" alt="menu">
        </button>

        <!-- Navigation -->
        <ul class="meta-ul">
            <li class="meta-navigation">
                <a class="meta-a" href="/mytripy-non">MyTripy</a>
            </li>

            <li class="meta-navigation">
                <a class="meta-a" href="/destinations">Destinations</a>
            </li>

            <li class="meta-navigation">
                <a class="meta-a" href="/contact">Contactez-nous</a>
            </li>

            <li class="meta-navigation-btn-connexion">
                <a class="btn" href="/profil">Mon Compte</a>
            </li>

            <li class="meta-navigation-btn-seconnecter">
                <a class="btn" href="/SeConnecter">Se connecter</a>
            </li>

            <li class="meta-navigation-btn-creer-compte">
                <a class="btn" href="/CreerCompte">CrÃ©er mon compte</a>
            </li>
        </ul>

    </header>


    <!-- Contenu principal -->
    <section>
        <div class="card">
            <div class="card-img">
                <img src="static/img/fond-profil.png" alt="fond profil">
            </div>
            <div class="card-avatar">
                <img src="{{.PhotoURL}}" id="photoProfil" onclick="openPopupProfil()">
            </div>

            <!-- Pseudo et Bio -->
            <p id="pseudo" class="pseudo">{{.Pseudo}}</p>
            <a class="btn-modifier-pseudo" onclick="openPopupModif()">Modifier profil</a>

            <div class="ConteneurProfil">
                <h4>Bio</h4>
                <p id="bio" class="bio">{{.Biography}}</p>
            </div>


            <!-- RÃ©gions Favorites -->
            <!-- <div class="favorites-regions-container">
                <h3 class="titre-favorite-region">RÃ©gions favorites</h3>
                <div class="favorite-region">
                    <div class="region-name">Auvergne-RhÃ´ne-Alpes</div>
                    <div class="coeur-container">
                        <img src="static/img/coeur.png" alt="Like" class="coeur" id="coeur-img">
                    </div>
                    <img src="static/img/vieux-port.png" alt="Auvergne-RhÃ´ne-Alpes">
                </div>
            </div> -->

            <h3 class="titre-favorite-region">RÃ©gions favorites</h3>
            <div class="destinations-favorites">
                <div class="destination-region-favorites">
                    <img src="static/img/vieux-port.png" alt="Auvergne-RhÃ´ne-Alpes" class="destination-image">
                    <div class="destination-details">
                        <div class="destination-region-name-favorites">Auvergne-RhÃ´ne-Alpes</div>
                        <div class="destination-description-favorites">
                            Soleil, mer et montagne.
                        </div>
                    </div>

                    <div class="destination-coeur-container">
                        <img src="static/img/coeur.png" alt="Like" class="destination-coeur">
                    </div>
                </div>
            </div>

            <h3 class="titre-favorite-region">Mes fils de discussion</h3>
            <div class="discussion">
                <div class="discussion-cree">
                    <div class="discussion-cree-info">
                        <img src="static/img/avatar/avatarHomme2.png" alt="" class="discussion-cree-info-profil">
                        
                        <div class="discussion-cree-info-texte">
                            <p class="discussion-cree-info-titre">Je cherche un parc Ã  Antibes</p>
                            <p class="discussion-cree-info-nom">Matias Bouchenoire</p>
                        </div>
                    </div>                
    
                    <p class="discussion-cree-descriptif">J'habite Ã  Antibes et jâ€™aimerais me promener ce week-end, mais je ne connais pas de bons parcs dans le coin. Des suggestions ? Merci dâ€™avance ! ðŸ˜Š</p>
                    
                    <div class="discussion-cree-chat">
                        <img src="static/img/messager.png" alt="discussion">
                        <p>152</p>
                    </div>
                </div>
            </div>

            <a class="btn-deconnexion" href="/logout">DÃ©connexion</a>
        </div>
    </section>

    
<!-- Overlay sombre -->
<div id="overlay-profil" class="overlay"></div>

<!-- Pop-up pour modifier la photo de profil -->
<div id="popup-profil" class="popup">
    <img src="../static/img/fondAvatar.png" class="fondAvatar">
    <h1>Choisissez votre Avatar</h1>
    <div class="imgAvatar">
        <div class="femme">
            <img src="../static/img/avatar/avatarFemme1.png" onclick="updateAvatar('../static/img/avatar/avatarFemme1.png')">
            <img src="../static/img/avatar/avatarFemme2.png" onclick="updateAvatar('../static/img/avatar/avatarFemme2.png')">
            <img src="../static/img/avatar/avatarFemme3.png" onclick="updateAvatar('../static/img/avatar/avatarFemme3.png')">
            <img src="../static/img/avatar/avatarFemme4.png" onclick="updateAvatar('../static/img/avatar/avatarFemme4.png')">
        </div>
        <div class="homme">
            <img src="../static/img/avatar/avatarHomme1.png" onclick="updateAvatar('../static/img/avatar/avatarHomme1.png')">
            <img src="../static/img/avatar/avatarHomme2.png" onclick="updateAvatar('../static/img/avatar/avatarHomme2.png')">
            <img src="../static/img/avatar/avatarHomme3.png" onclick="updateAvatar('../static/img/avatar/avatarHomme3.png')">
            <img src="../static/img/avatar/avatarHomme4.png" onclick="updateAvatar('../static/img/avatar/avatarHomme4.png')">
        </div>
    </div>
</div>


<!-- Overlay sombre pour le pop-up de modification -->
<div id="overlay-modif" class="overlay"></div>

<!-- FenÃªtre pop-up de modification -->
<div id="popup-modif" class="popup-modif">
    <h3>Modifier Profil</h3>
    <div class="modif">
        <h4>Pseudo</h4>
        <input type="text" id="nouveauPseudo" placeholder="Entrez un nouveau pseudo">

        <h4>Bio</h4>
        <textarea id="nouvelleBio" placeholder="Entrez une nouvelle bio"></textarea>
    </div>

    <button onclick="updateProfile()">Sauvegarder</button>
</div>

<script>
    // Fonction pour mettre Ã  jour l'avatar
    function updateAvatar(avatarURL) {
        fetch('/updateProfile', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                avatar: avatarURL
            })
        })
        .then(response => {
            if (!response.ok) {
                throw new Error('Erreur lors de la mise Ã  jour de l\'avatar');
            }
            return response.json();
        })
        .then(data => {
            console.log(data.message);
            // Mettre Ã  jour l'avatar sur la page
            document.getElementById('photoProfil').src = avatarURL;
        })
        .catch(error => console.error(error));
    }

    // Fonction pour mettre Ã  jour le pseudo et la bio
    function updateProfile() {
        const pseudo = document.getElementById('nouveauPseudo').value;
        const bio = document.getElementById('nouvelleBio').value;

        fetch('/updateProfile', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                pseudo: pseudo,
                bio: bio
            })
        })
        .then(response => {
            if (!response.ok) {
                throw new Error('Erreur lors de la mise Ã  jour du profil');
            }
            return response.json();
        })
        .then(data => {
            console.log(data.message);
            // Mettre Ã  jour les informations sur la page
            document.getElementById('pseudo').innerText = pseudo;
            document.getElementById('bio').innerText = bio;
        })
        .catch(error => console.error(error));
    }
</script>
    <script src="static/script.js"></script>
</body>
</html>