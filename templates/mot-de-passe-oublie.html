<!DOCTYPE html>
<html lang="fr">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description" content="Forum de voyage - Partagez vos expériences et conseils sur les destinations de la France.">
        <meta name="keywords" content="forum, voyage, destinations, partage, communauté">
        <meta name="author" content="Matias, Sara, Samuel, William">
        <link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&family=Pacifico&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=Sen:wght@400;600;800&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700&display=swap" rel="stylesheet">
        <title>MyTripy</title>
        <link rel="stylesheet" href="static/css/styles.css">
        <link rel="stylesheet" href="static/css/styles-desktop.css" media="screen and (min-width: 1024px)">
    </head>
    <body>
        <!-- Header -->
        <header>
            <!-- Logo -->
            <a href="/mytripy-non" class="logo">
                <img class="image_logo" src="static/img/logo/logo-mytripy-2.png" alt="MyTripy Logo">
                <img class="mytripy" src="static/img/logo/mytripy.png" alt="MyTripy">
            </a>

            <!-- Menu Burger -->
            <button class="burger-menu" id="burger">
                <img src="static/img/menu-black.png" alt="menu">
            </button>
        </header>

        <!-- Navigation -->
        <ul class="meta-ul">
            <li class="meta-navigation">
                <a class="meta-a" href="/mytripy-non">MyTripy</a>
            </li>
            <li class="meta-navigation">
                <a class="meta-a" href="/destinations">Destinations</a>
            </li>
            <li class="meta-navigation">
                <a class="meta-a" href="/contact">Contactez-nous</a>
            </li>
            <li class="meta-navigation-btn-seconnecter">
                <a class="btn" href="/SeConnecter">Se connecter</a>
            </li>
            <li class="meta-navigation-btn-creer-compte">
                <a class="btn" href="/CreerCompte">Créer mon compte</a>
            </li>
        </ul>

        <!-- Conteneur Principal -->
        <section>
            <div class="card">
                <div class="card-img">
                    <img src="static/img/fond-profil-3.png" alt="fond profil">
                </div>

                <div class="card-titre">
                    <h3 class="titre-mot-de-passe-oublie">Réinitialisation du mot de passe</h3>
                    <p class="sous-titre-SeConnecter">Renseignez les informations ci-dessous pour réinitialiser votre mot de passe</p>
                </div>

                <!-- Formulaire -->
                <form id="resetPasswordForm">
                    <div class="ConteneurMotDePasseOublie">
                        <h4>Votre Email</h4>
                        <div class="ConteneurEmail">
                            <input type="email" id="Email" placeholder="nom@email.com" required>
                            <img src="/static/img/email.png" alt="Icône email">
                        </div>

                        <h4>Votre pseudo</h4>
                        <div class="ConteneurEmail">
                            <input type="text" id="Pseudo" placeholder="Votre pseudo" required>
                            <img src="/static/img/utilisateur.png" alt="Icône utilisateur">
                        </div>
                    
                        <h4>Nouveau mot de passe</h4>
                        <div class="ConteneurEmail">
                            <input type="password" id="NouveauMotDePasse" placeholder="Mot de passe" required>
                            <img src="/static/img/cadenas.png" alt="Icône cadenas">
                        </div>
                        <div class="ConteneurMotDePasse">
                            <input type="password" id="ConfirmeMotDePasse" placeholder="Confirmer votre mot de passe" required>
                            <img src="/static/img/cadenas.png" alt="Icône cadenas">
                        </div>
                    </div>

                    <button type="submit" class="btn-SeConnecter">Réinitialiser</button>
                </form>
            </div>
        </section>
        <script>
           document.getElementById("resetPasswordForm").addEventListener("submit", async function (event) {
    event.preventDefault();

    const email = document.getElementById("Email").value;
    const username = document.getElementById("Pseudo").value;
    const newPassword = document.getElementById("NouveauMotDePasse").value;
    const confirmPassword = document.getElementById("ConfirmeMotDePasse").value;

    try {
        const response = await fetch("/api/password-reset", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ email, username, newPassword, confirmPassword }),
        });

        if (response.ok) {
            alert("Mot de passe réinitialisé avec succès !");
            window.location.href = "/SeConnecter";
        } else {
            const errorText = await response.text();
            alert("Erreur : " + errorText);
        }
    } catch (error) {
        alert("Erreur réseau : " + error.message);
    }
});
        </script>
        <script src="static/script.js"></script>
    </body>
</html>